<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/style.css" media="screen" />
    <script src="js/jquery.timelinr-0.9.54.js"></script>
    <script>
      $(function(){
        $().timelinr({
          autoPlay: 'false',
          autoPlayDirection: 'forward'
        })
      });
    </script>
  </head>

  <body>
    <div id="play-button">
      <button id="play">play</button>
      <span id="clock">year</span>
    </div>

  <div class="row">
    <div id="map" class="col-md-9">
    </div>
    <div id="pics" class="col-md-3">

        <img src="pics\1912\D.jpg" id="pic1" class="img-circle" alt="Cinque Terre" width="80c" height="80"></img>
        <span id="dem-name">Woodrow Wilson</span><span id="dem-span"><br>6,294,284<br><br></span>

      <img src="pics\1912\R.jpg" id="pic2" class="img-circle" alt="Cinque Terre" width="80" height="80"></img>
      <span id="rep-name">William Taft</span><span id="rep-span"><br>3,487,937<br><br></span>

      <img src="pics\1912\O.jpg" id="pic3" class="img-circle" alt="Cinque Terre" width="80" height="80"></img>
      <span id="other-name">Theodore Roosevelt & Others</span><span id="other-span"><br>5,263,325<br><br></span>
        <div id="eventDiv">
          <!-- <h2 id="event1">EVENT #1</h2> -->
          </div>
    </div>

           
</div>

  </div>

  <!-- <h2 id="event1">EVENT #1</h2> -->
  <div id="timeline" class="col-md-7">
    <ul id="dates">
        <li><a id="1912">1912</a></li>
        <li><a id="1916">1916</a></li>
        <li><a id="1920">1920</a></li>
        <li><a id="1924">1924</a></li>
        <li><a id="1928">1928</a></li>
        <li><a id="1932">1932</a></li>
        <li><a id="1936">1936</a></li>
        <li><a id="1940">1940</a></li>
        <li><a id="1944">1944</a></li>
        <li><a id="1948">1948</a></li>
        <li><a id="1952">1952</a></li>
        <li><a id="1956">1956</a></li>
        <li><a id="1960">1960</a></li>
        <li><a id="1964">1964</a></li>
        <li><a id="1968">1968</a></li>
        <li><a id="1972">1972</a></li>
        <li><a id="1976">1976</a></li>
        <li><a id="1980">1980</a></li>
        <li><a id="1984">1984</a></li>
        <li><a id="1988">1988</a></li>
        <li><a id="1992">1992</a></li>
        <li><a id="1996">1996</a></li>
        <li><a id="2000">2000</a></li>
        <li><a id="2004">2004</a></li>
        <li><a id="2008">2008</a></li>
        <li><a id="2012">2012</a></li>
    </ul>
  </div>

<!--   <div id="events" class="col-md-3">
              <h2 id="event1">EVENT #1</h2>

             <h2 id="event2">EVENT #2</h2>

             <h2 id="event3">EVENT #2</h2>
             </div>  

             </div> -->

  <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
  <script src="//d3js.org/queue.v1.min.js"></script>
  <script src="//d3js.org/topojson.v1.min.js"></script>
  <script>
  var width, height, projection, path, graticule, svg, attributeArray = [], currentAttribute = 0, playing = false;

   var events = {

 "1916": ["May 15, 1917: First regular airmail service begins, with one round trip a day between Washington, DC, and New York", "1920: Worldwide influenza epidemic strikes. Nearly 20 million people die worldwide - 500,000 in the U.S."],

 "1920": ["July 2, 1920: Pres. Warren G. Harding signs resolution declaring peace with Austria and Germany", "August 2, 1923: President Harding dies suddenly. He is succeeded by his vice president, Calvin Coolidge", ""],

 "1924": ["May 10, 1924: J. Edgar Hoover is appointed director of the Bureau of Investigation", "May 20-21, 1927: Charles Lindbergh makes the first solo nonstop transatlantic flight in his plane The Spirit of St. Louis", ""],

 "1928": ["October 29, 1929: Stock market crash precipitates the Great Depression", "May 1, 1931: The Empire State Building opened in New York City", "January 12, 1932: Hattie Wyatt Caraway of Arkansas is the first woman elected to the U.S. Senate"],

 "1932": ["March-June, 1933: New Deal recovery measures are enacted by Congress", "August 14, 1935: Social Security Act is passed"],

  "1936": ["June 5, 1938: Fair Labor Standards Act is passed, setting the first minimum wage in the U.S. at 25 cents per hour", "June 25, 1938: Fair Labor Standards Act is passed, setting the first minimum wage in the U.S. at 25 cents per hour", "September 5, 1939: World War II: U.S. declares its neutrality in European conflict"],

  "1940": ["December 7, 1941: Japan attacks Pearl Harber - US enters World War II", "August 13, 1942: The Manhattan Project begins", "June 6, 1944: U.S. and allies invade France on D-Day"],

  "1944": ["April 12, 1945: President Roosevelt dies of a stroke (April 12) - President Harry Truman is sworn in", "May 7, 1945: Germany surrenders unconditionally", "August 1945: US drops atomic bombs on Hiroshima and Nagasaki - Japan surrenders"],

  "1948": ["948: President Harry S. Truman was reelected to a second term, defeating New York Governor Thomas E. Dewey, and South Carolina Governor Strom Thurmond, in what is regarded as one of the biggest upsets in American political history", "June 24, 1948: Soviets begin blockade of Berlin in the first major crisis of the cold war", "June 27, 1950: President Truman, without the approval of Congress, commits American troops to Korea"],

  "1952": ["May 17, 1954: Brown v. Board of Education: The Supreme Court declares that state laws establishing separate public schools for black and white students, and denying black children equal educational opportunities, were unconstitutional", "April 12, 1955: The announcement that the polio vaccine developed by Jonas Salk was found to be 'safe, effective and potent' was made by the University of Michigan.", "June 9, 1954: Senator McCarthy was nationally discredited after failing to provide credible evidence supporting accusations of communist activity in the U.S. government", "1955: the African-American Civil Rights Movement is propelled by events such as the murder of Emmitt Till and the arrest and of Rosa Parks"],

  "1956": ["1959: Hawaii and Alaska are admitted to the Union", "May 6, 1960: The Civil Rights Act of 1960, establishing federal inspection of local voter registration polls and penalties for those attempting to obstruct the right to vote, was signed into law"],

  "1960": ["October 1962: Cuban missile crisis, a nuclear confrontation takes place between the United States and the Soviet Union", "November 22, 1963: President John F. Kennedy is assassinated by a sniper in Dallas, Texas - Vice President Lyndon B. Johnson is sworn in as President", "1964: The Civil Rights Act of 1964 is signed into law"],

  "1964": ["1965: Pres. Johnson escalates United States military involvement in the Vietnam War dramatically with troops totaling more than 184,000", "1967: the Summer of Love takes place, marking a defining period for the counterculture movement in the U.S.", "April 4, 1968: Dr. Martin Luther King Jr. is assasinated"],

  "1968": ["July 20, 1969: Apollo 11: American astronauts land on the moon", "December 15, 1969: President Nixon announces the withdrawal of 50,000 U.S. troops from Vietnam; reaching the peak level of U.S. troops in Vietnam at 541,000"],

  "1972": ["June 17, 1972: Five men were arrested for the burglary of the Democratic National Committee headquarters at the Watergate complex in Washington, D.C","January 22, 1973: Roe v. Wade: The Supreme Court ruled that state laws banning abortion before 24 weeks as unconstitutional", "August 9, 1974: President Richard Nixon becomes the first and only President to resign from office - Gerald Ford is sworn in", "1975: Bill Gates founds Microsoft, Steve Jobs founds Apple a year later"],

  "1976": ["November 27, 1978: Harvey Milk, the first openly gay person elected to public office, and San Francisco Mayor George Moscone, were assassinated in San Francisco", "November 4, 1979: Iran hostage crisis begins after the U.S. embassy in Tehran is raided by activists of the Iranian Revolution", "June 1, 1980: CNN, the first 24-hour cable news channel"],

  "1980": ["March 30, 1981: President Reagan and three others were injured after an assassination attempt of the President", "August 2, 1981: Reaganomics: The Kemp-Roth Tax Cut was signed into law", "March 23, 1983: President Reagan proposes the Strategic Defense Initiative"],

  "1984": ["November 3, 1986: Iranâ€“Contra affair: The Lebanese magazine Ash-Shiraa reveals that the U.S. had secretly sold weapons to Iran in exchange for American hostages", "October 19, 1987: Black Monday: The Dow Jones Industrial Average fell 508 points in a single session, losing 22.6% of its value", "December 8, 1987: The Intermediate-Range Nuclear Forces Treaty was signed in Washington, D.C. between the U.S. and Soviet Union"],

  "1988": ["June 1, 1980: The 1990 Chemical Weapons Accord was signed between the United States and the Soviet Union", "January 17, 1991: Operation Desert Storm: The United States invades Iraq in response to Iraqs annexation of Kuwait - Pres. George H.W. Bush announces a cease fire 5 weeks later", "1992: Riots in Los Angeles, spurred by the acquittal of four LAPD officers accused in the beating of Rodney King, took place, which resulted in over fifty deaths and $1 billion in damage"],

  "1992": ["February 26, 1993: A truck bomb explodes in the parking garage under the World Trade Center in Manhattan, killing six people and injuring 1,042 others.", "November 30, 1993: The Don't ask, don't tell policy, prohibiting openly gay and bisexual people from serving in the military, was signed into law", "November 8, 1994: The Republican Party picked up 54 seats in the House and 8 seats in the Senate, being one of the largest shifts in party balance in U.S. congressional history"],

  "1996": ["1998: U.S. embassy bombings: 224 were killed in bombings in Tanzania and Kenya.", "1998: Pres. Bill Clinton is impeached", "1999: The Dow Jones Industrial Average closed at 10,006.78", "October 12, 2000: USS Cole bombing: The USS Cole was bombed in Yemeni waters, killing seventeen United States Navy sailors"],

  "2000": ["September 11, 2001: terrorists hijack four planes and crash them into the World Trade Center, the Pengatagon and a field in Shanksville, PA killing 2,996 people and injuring over 6,000", "October 7, 2001: The United States launched an invasion of Afghanistan", "March 19, 2003: The United States and allies invade Iraq"],

  "2004": ["2004: The social networking website Facebook was launched", "November 7, 2004: The Democratic Party regained control of both houses of Congress and gained control of a majority of state governorships", "September 14, 2008: Investment bank Lehman Brothers files for bankruptcy, the largest in U.S. history"],

  "2008": ["February 17, 2009: President Barack Obama signed the American Recovery and Reinvestment Act of 2009, a $787 billion economic stimulus package", "May 2, 2011: Osama bin Laden was killed by United States forces in Abbottabad, Pakistan", "December 18, 2011: The last United States troops withdrew from Iraq"],

  "2012": ["To be continued Tuesday, November 8, 2016"] }

  var facts = {
    "1912": {"D": ["Woodrow Wilson", "6,294,284"], "R": ["William Taft", "3,487,937"], "O": ["Theodore Roosevelt & Others", "5,263,325"]},
    "1916":{"D": ["Woodrow Wilson", "9,130,861"], "R": ["Charles Hughes", "8,549,700"] , "O": ["Other", "860,757"]},
    "1920":{"D": ["James Cox", "9,140,256"], "R": ["Warren Harding", "16,166,126"] , "O": ["Other", "1,481,843"]},
    "1924":{"D": ["John Davis", "8,384,341"], "R": ["Calvin Coolidge", "15,719,068"] , "O": ["Robert LaFollette & Others", "4,989,215"]},
    "1928":{"D": ["Alfred Smith", "15,015,863"], "R": ["Herbert Hoover", "21,428,584"] , "O": ["Other", "364,514"]},
    "1932":{"D": ["Franklin Roosevelt", "22,821,513"], "R": ["Herbert Hoover", "15,761,532"] , "O": ["Other", "1,169,409"]},
    "1936":{"D": ["Franklin Roosevelt", "27,757,431"], "R": ["Alfred Landon", "16,683,574"] , "O": ["Other", "1,213,383"]},
    "1940":{"D": ["Franklin Roosevelt", "27,314,449"], "R": ["Wendell Willlkie", "22,348,343"] , "O": ["Other", "250,060"]},
    "1944":{"D": ["Franklin Roosevelt", "25,612,916"], "R": ["Thomas Dewey", "22,017,929"] , "O": ["Other", "346,247"]},
    "1948":{"D": ["Harry Truman", "24,179,347"], "R": ["Thomas Dewey", "21,991,292"] , "O": ["Strom Thurmond & Others", "2,624,071"]},
    "1952":{"D": ["Adlai Stevenson", "27,375,090"], "R": ["Dwight Eisenhower", "34,075,529"] , "O": ["Other", "301,323"]},
    "1956":{"D": ["Adlai Stevenson", "26,028,028"], "R": ["Dwight Eisenhower", "35,579,180"] , "O": ["Other", "414,771"]},
    "1960":{"D": ["John Kennedy", "34,220,984"], "R": ["Richard Nixon", "34,108,157"] , "O": ["Other", "503,342"]},
    "1964":{"D": ["Lyndon Johnson", "43,129,040"], "R": ["Barry Goldwater", "27,175,754"] , "O": ["Other", "336,745"]},
    "1968":{"D": ["Hubert Humphrey", "31,271,839"], "R": ["Richard Nixon", "31,783,783"] , "O": ["George Wallace & Others", "10,144,377"]},
    "1972":{"D": ["George McGovern", "29,173,222"], "R": ["Richard Nixon", "47,168,710"] , "O": ["Other", "1,402,098"]},
    "1976":{"D": ["Jimmy Carter", "40,831,881"], "R": ["Gerald Ford", "39,148,634"] , "O": ["Other", "1,560,265"]},
    "1980":{"D": ["Jimmy Carter", "35,480,115"], "R": ["Ronald Reagan", "43,903,230"] , "O": ["John Anderson & Others", "7,126,333"]},
    "1984":{"D": ["Walter Mondale", "37,577,352"], "R": ["Ronald Reagan", "54,455,472"] , "O": ["Other", "620,409"]},
    "1988":{"D": ["Michael Dukakis", "41,809,476"], "R": ["George Bush", "48,886,597"] , "O": ["Other", "898,613"]},
    "1992":{"D": ["Bill Clinton", "44,909,806"], "R": ["George Bush", "39,104,550"] , "O": ["Ross Perot & Others", "20,412,255"]},
    "1996":{"D": ["Bill Clinton", "47,400,125"], "R": ["Bob Dole", "39,198,755"] , "O": ["Other", "9,676,760"]},
    "2000":{"D": ["Al Gore", "51,009,810"], "R": ["George W. Bush", "50,462,412"], "O": ["Ralph Nader & Others", "3,953,763"]},
    "2004":{"D": ["John Kerry", "59,027,115"], "R": ["George W. Bush", "62,039,572"], "O": ["Ralph Nader & Others", "1,236,903"]},
    "2008":{"D": ["Barack Obama", "69,499,428"], "R": ["John McCain", "59,950,323"], "O": ["Ralph Nader & Others", "2,023,954"]},
    "2012":{"D": ["Barack Obama", "65,918,507"], "R": ["Mitt Romney", "60,934,407"], "O": ["Other", "2,384,728"]}
      }

  function init() {
    setMap();
    animateMap();
  }
  function setMap() {

    width = 960, height = 600;
    projection = d3.geo.albersUsa()
        .scale(1000)
        .translate([width / 2, height / 2]);
    path = d3.geo.path()
        .projection(projection);
    svg = d3.select("#map").append("svg")
        .attr("width", width)
        .attr("height", height);

    svg.append("foreignObject")
      .attr("width", 200)
    .attr("height", 100)
    .attr("x",500)
    .attr("y",480)
    .attr("id", "event1")
    .append("xhtml:body")
    .html("<p>1912: Former President Theodore Roosevelt left the Republican Party and launched an unsuccessful campaign as a Progressive Candidate (In Green)</p>");

    loadData();

    //       .attr("width", 120)
    // .attr("height", 200)
    // .attr("x",800)
    // .attr("y",300)

  }

  function loadData() {
    queue()
        .defer(d3.json, "us.json")
        .defer(d3.csv, "datasofar24.csv")
        .await(processData);
  }
  function processData(error, us, countyData) {
    var counties = us.objects.counties.geometries;
    for (var i in counties) {
      counties[i].properties = {"id": counties[i].id};
      for (var j in countyData) {
        if (counties[i].properties.id == countyData[j].id) {
          for(var k in countyData[i]) {
            if(k != 'name' && k != "id") {
              if(attributeArray.indexOf(k) == -1 ) {
                attributeArray.push(k);
              }
              counties[i].properties[k] = countyData[j][k];
            }
          }
          break;
        }
      }
    }
    d3.select('#clock').html(attributeArray[currentAttribute]);
    drawMap(us);
  }

  function drawMap(us) {
    svg.selectAll(".county")
    .data(topojson.feature(us, us.objects.counties).features)
    .enter().append("path")
    .attr("class", "county")
    .attr("id", function(d){
      return "code_" + d.properties.id; }, true)
    .attr("d", path);

    d3.selectAll(".county")
    .attr('fill', function(d){
      return '#' + d.properties[attributeArray[currentAttribute]];
    });
  }

  function sequenceMap() {
    d3.selectAll('.county').transition()
      .duration(1000)
      .attr('fill', function(d){
        return '#' + d.properties[attributeArray[currentAttribute]];
      })
       current_year = attributeArray[currentAttribute].toString();
            $('#dem-name').html(facts[current_year]["D"][0]);
            $('#dem-span').html("<br>" + facts[current_year]["D"][1] + "<br><br>");
            $('#rep-name').html(facts[current_year]["R"][0]);
            $('#rep-span').html("<br>" + facts[current_year]["R"][1] + "<br><br>");
            $('#other-name').html(facts[current_year]["O"][0]);
            $('#other-span').html("<br>" + facts[current_year]["O"][1] + "<br><br>");
            
  }

  function sequenceEvents() {

  n = 0
  current_year = attributeArray[currentAttribute].toString();

  var current = events[current_year]
  // var eventIndex = -1;

  var eventPane = $('#event1')

  function showNextEvent() {

    for (var i=0; i<3; i++){
      

        $('#event1')
            .fadeIn(300).text(current[i])
            .delay(2000)
            .fadeOut(300, showNextEvent);
      }
    }

    showNextEvent();

}

  function setPics() {
      pic1path = "pics/" + attributeArray[currentAttribute] + "/D.jpg"
      pic2path = "pics/" + attributeArray[currentAttribute] + "/R.jpg"
      pic3path = "pics/" + attributeArray[currentAttribute] + "/O.jpg"

          $('#pic1').fadeOut(300, function() {
            $('#pic1').attr("src",pic1path);
            $('#pic1').fadeIn(300);
          });

          $('#pic2').fadeOut(300, function() {
            $('#pic2').attr("src",pic2path);
            $('#pic2').fadeIn(300);

          });

          $('#pic3').fadeOut(300, function() {
            $('#pic3').attr("src",pic3path);
            $('#pic3').fadeIn(300);
          });

          sequenceEvents();
          sequenceMap();
  }

  function animateMap(){
    var timer;
    d3.select('#play')
    .on('click', function(){
      if(playing == false) {
        timer = setInterval(function(){
          if(currentAttribute < attributeArray.length - 1) {
            currentAttribute += 1;
          } else {
            currentAttribute = 0;
          }


          var widthDate = $(settings.datesDiv+' li').width();
          var defaultPositionDates = parseInt($(settings.datesDiv).css('marginLeft').substring(0,$(settings.datesDiv).css('marginLeft').indexOf('px')));
          id = '#' + attributeArray[currentAttribute]
          var currentIndex = $(id).parent().prevAll().length;
          $(settings.datesDiv).animate({'marginLeft':defaultPositionDates-(widthDate)});
          $(settings.datesDiv+' a').removeClass(settings.datesSelectedClass);
          $(id).addClass(settings.datesSelectedClass);
          $('#clock').html(attributeArray[currentAttribute]);

          setPics();

        }, 8000);

        d3.select(this).html('stop');
        playing = true;
      } else {
        clearInterval(timer);
        d3.select(this).html('play');
        playing = false;
      }
    });
  }
  window.onload = init();
  </script>
  </body>
</html>